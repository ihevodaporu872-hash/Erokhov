// Реальные диаметры труб (DN)
export const REAL_DN = [15, 20, 25, 32, 40, 50, 65, 80, 100, 125, 150];

// Нормы расхода хомутов для стальных оцинкованных труб
// Ключ — диаметр трубы (DN), значение — название хомута и норма (шт/м)
export const STEEL_ZN_CLAMPS_RULES = {
  15: { name: 'Хомут для труб ст/оц. 1/2"', norm: 0.7 },
  20: { name: 'Хомут для труб ст/оц. 3/4"', norm: 0.5 },
  25: { name: 'Хомут для труб ст/оц. 1/8"-6"', norm: 0.7 },
  32: { name: 'Хомут для труб ст/оц. 1 1/4"', norm: 0.7 },
  40: { name: 'Хомут для труб ст/оц. 1 1/2"', norm: 0.7 },
  50: { name: 'Хомут для труб ст/оц. 2"', norm: 0.7 },
  65: { name: 'Хомут для труб ст/оц. 2 1/2"', norm: 0.7 },
  80: { name: 'Хомут для труб оц. под высокую нагрузку М12 3"', norm: 0.7 },
  100: { name: 'Хомут для труб оц. под высокую нагрузку М12 4"', norm: 0.7 },
};

// Нормы расхода фитингов для труб PP-R (сшитый полиэтилен)
// Ключ — диаметр трубы (Ду), значение — массив фитингов с нормами (шт/м)
export const PPR_FITTINGS_RULES = {
  16: [
    { name: 'Фиксатор загиба 16', unit: 'шт', norm: 0.45 },
    { name: 'Соединение угловое 16х16', unit: 'шт', norm: 0.45 },
    { name: 'Переходник с нар. резьбой 16-R 1/2"', unit: 'шт', norm: 0.07 },
    { name: 'Крюк пласт. для труб одинарный 14-25', unit: 'шт', norm: 0.30 },
    { name: 'Гильза лат. Ду 16', unit: 'шт', norm: 1.55 },
    { name: 'Крюк пласт. для труб двойной 14-25', unit: 'шт', norm: 0.50 },
    { name: 'Тройник лат.16х16х16', unit: 'шт', norm: 0.145 },
    { name: 'Тройник лат.20х16х16', unit: 'шт', norm: 0.055 },
  ],
  20: [
    { name: 'Фиксатор загиба 20', unit: 'шт', norm: 0.45 },
    { name: 'Соединение угловое 20х20', unit: 'шт', norm: 0.35 },
    { name: 'Тройник лат.20х20х16', unit: 'шт', norm: 0.06 },
    { name: 'Крюк пласт. для труб одинарный 14-25', unit: 'шт', norm: 0.40 },
    { name: 'Гильза лат. Ду 20', unit: 'шт', norm: 0.90 },
    { name: 'Крюк пласт. для труб двойной 14-25', unit: 'шт', norm: 0.50 },
    { name: 'Тройник лат.20х16х20', unit: 'шт', norm: 0.10 },
    { name: 'Тройник лат.20х20х20', unit: 'шт', norm: 0.01 },
    { name: 'Переходник с нар. резьбой 20-R 3/4"', unit: 'шт', norm: 0.06 },
  ],
  25: [
    { name: 'Соединение угловое 25х25', unit: 'шт', norm: 0.10 },
    { name: 'Переходник с нар. резьбой 25-R 3/4"', unit: 'шт', norm: 0.06 },
    { name: 'Тройник лат.25х25х16', unit: 'шт', norm: 0.06 },
    { name: 'Тройник лат.25х16х25', unit: 'шт', norm: 0.10 },
    { name: 'Тройник лат.25х16х20', unit: 'шт', norm: 0.10 },
    { name: 'Фиксатор загиба 25', unit: 'шт', norm: 0.45 },
    { name: 'Гильза лат. Ду 25', unit: 'шт', norm: 0.90 },
    { name: 'Тройник лат.25х20х16', unit: 'шт', norm: 0.10 },
    { name: 'Тройник лат.25х20х25', unit: 'шт', norm: 0.06 },
    { name: 'Крюк пласт. для труб двойной 14-25', unit: 'шт', norm: 0.50 },
  ],
  32: [
    { name: 'Фиксатор загиба 32', unit: 'шт', norm: 0.45 },
    { name: 'Гильза лат. Ду 32', unit: 'шт', norm: 0.90 },
    { name: 'Тройник лат.32х32х25', unit: 'шт', norm: 0.06 },
    { name: 'Тройник лат.32х25х32', unit: 'шт', norm: 0.10 },
    { name: 'Тройник лат.32х20х25', unit: 'шт', norm: 0.10 },
    { name: 'Соединение угловое 32х32', unit: 'шт', norm: 0.10 },
    { name: 'Переходник с нар. резьбой 32-R 3/4"', unit: 'шт', norm: 0.06 },
    { name: 'Крюк пласт. для труб одинарный 32', unit: 'шт', norm: 0.50 },
  ],
};

// Типы альбомов КУУ
export const ALBUMS = {
  collector: 'Коллекторный',
  collector_pre_apt: 'Коллекторный с подключением перед квартирой',
  pre_apt: 'С подключением перед квартирой'
};

// Ключи альбомов для итерации
export const albumKeys = ['collector', 'collector_pre_apt', 'pre_apt'];

// Шаблоны BOM для КУУ
export const KUU_BOM_TEMPLATES = {
  collector: [
    { nameTpl: 'Кран шаровый Ду 32', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Кран шаровый Ду 15', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Фильтр сетчатый косой Ду 32', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Регулятор давления Ду 32', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Манометр', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Коллектор на {n} подключений', qtyPerApt: 2, unit: 'шт' },
    { nameTpl: 'Кран сливной Ду 15', qtyPerApt: 2, unit: 'шт' },
  ],
  collector_pre_apt: [],
  pre_apt: []
};

// Генератор уникальных идентификаторов
export function uid() {
  return Date.now() + Math.floor(Math.random() * 1e6);
}

// Таблица соответствий: DN трубы → DN гильзы
// Гильза должна быть на два типоразмера больше трубы
export const PIPE_TO_SLEEVE_DN = {
  15: 25,   // 15 → (20) → 25
  20: 32,   // 20 → (25) → 32
  25: 40,   // 25 → (32) → 40
  32: 50,   // 32 → (40) → 50
  40: 65,   // 40 → (50) → 65
  50: 80,   // 50 → (65) → 80
  65: 100,  // 65 → (80) → 100
  80: 125,  // 80 → (100) → 125
  100: 150, // 100 → (125) → 150
  125: 200, // 125 → (150) → 200
  150: 250  // 150 → (200) → 250
};

/**
 * Получить диаметр гильзы по диаметру трубы
 * @param {number} pipeDn - диаметр трубы (DN)
 * @returns {number} - диаметр гильзы (DN)
 */
export function getSleeveDn(pipeDn) {
  return PIPE_TO_SLEEVE_DN[pipeDn] || pipeDn + 15; // fallback: +15 если нет в таблице
}